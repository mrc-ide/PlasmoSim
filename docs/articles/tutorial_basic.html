<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic tutorial • PlasmoSim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic tutorial">
<meta property="og:description" content="PlasmoSim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PlasmoSim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial_basic.html">Running a basic model</a>
    </li>
    <li>
      <a href="../articles/tutorial_movement.html">Space and human movement</a>
    </li>
    <li>
      <a href="../articles/tutorial_relatedness.html">Pairwise relatedness</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/PlasmoSim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tutorial_basic_files/kePrint-0.0.1/kePrint.js"></script><link href="tutorial_basic_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/PlasmoSim/blob/HEAD/vignettes/tutorial_basic.Rmd" class="external-link"><code>vignettes/tutorial_basic.Rmd</code></a></small>
      <div class="hidden name"><code>tutorial_basic.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>PlasmoSim returns two types of output:</p>
<ol style="list-style-type: decimal">
<li>Population-level data giving basic epidemiological measures
(e.g. prevalence) on each day of simulation</li>
<li>Individual-level data, including parasite genotypes found in the
host at specific sampling points</li>
</ol>
<p>For the latter, we need to define our desired sampling strategy using
a data.frame. This specifies the demes that we will sample from, at what
time points, and how many hosts will be drawn at random from the
population:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define individual-level sampling via a data.frame</span></span>
<span><span class="va">sample_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>deme <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                        time <span class="op">=</span> <span class="fl">365</span>,</span>
<span>                        n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>Now we run the main simulation function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run simulation</span></span>
<span><span class="va">sim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_falciparum.html">sim_falciparum</a></span><span class="op">(</span>H <span class="op">=</span> <span class="fl">1000</span>,                     <span class="co"># human population size</span></span>
<span>                       M <span class="op">=</span> <span class="fl">5000</span>,                     <span class="co"># adult female mosquito population size</span></span>
<span>                       seed_infections <span class="op">=</span> <span class="fl">100</span>,        <span class="co"># number of infected hosts at time 0</span></span>
<span>                       L <span class="op">=</span> <span class="fl">24</span>,                       <span class="co"># number of loci</span></span>
<span>                       sample_dataframe <span class="op">=</span> <span class="va">sample_df</span>  <span class="co"># sampling data.frame</span></span>
<span>                       <span class="op">)</span></span>
<span><span class="co">#&gt; Running simulation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; simulation completed in 0.0289871 seconds</span></span>
<span><span class="co">#&gt; processing output</span></span></code></pre></div>
<p>Daily output is stored in long format, which makes it easy to produce
plots:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># basic plot of prevalence in "I" state (infected)</span></span>
<span><span class="va">sim1</span><span class="op">$</span><span class="va">daily_values</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">I</span> <span class="op">/</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Prevalence (%)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_basic_files/figure-html/unnamed-chunk-6-1.png" width="70%" height="70%"></p>
<p>We can see that prevalence jumped to 10% (100 infected hosts in the
population of 1000) on day 13. This is because we set the simulation
going with 100 seed infections, which here means new liver-stage
infections. The default time from liver-stage to blood-stage (the
intrinsic incubation period) is set to by default, hence these all
emerging together on day 13. After this point we can see dynamic and
stochastic changes in the number infected.</p>
<p>Individual-level output is also returned in long format. We will use
the <code>kable</code> package to make this slightly easier to read:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take a peek at basic individual-level output, without the haplotypes column</span></span>
<span><span class="va">sim1</span><span class="op">$</span><span class="va">indlevel</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">scroll_box</span><span class="op">(</span>width <span class="op">=</span> <span class="st">"1000px"</span>, height <span class="op">=</span> <span class="st">"400px"</span><span class="op">)</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:1000px; ">
<table class="table table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
time
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
deme
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sample_ID
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
positive
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
haplotypes
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
haplo_ID
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
89
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81,
81, 81, 81, 81, 81, 81
</td>
<td style="text-align:left;">
7bb9cce5c9911a60f4e7f1e827615768
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
101
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
106
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
113
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39,
39, 39, 39, 39, 39, 39
</td>
<td style="text-align:left;">
468815117ba482205c8aa5d5eca5d558
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
136
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
142
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
14, 14, 14, 14, 14, 14
</td>
<td style="text-align:left;">
5a04f475aaafb7d8d57fb74d15afdf98
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
159
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
176
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53,
53, 53, 53, 53, 53, 53
</td>
<td style="text-align:left;">
0d05caa56fd36e9a1b89ec813cef6de7
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
183
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
194
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
17, 17, 17, 17, 17, 17
</td>
<td style="text-align:left;">
a7ec324ac08f16ea346bc7d8a3c6d4bc
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
204
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
227
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
240
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
263
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
275
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
284
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
287
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,
21, 21, 21, 21, 21, 21
</td>
<td style="text-align:left;">
5eba0a09b0d61a2da0d5bd4fffc6516f
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
288
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
291
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
350
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
354
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
356
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47,
47, 47, 47, 47, 47, 47
</td>
<td style="text-align:left;">
1938d4f28086e6687ede6b64163e9e3d
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
363
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
374
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
381
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
390
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
47, 89, 47, 89, 47, 89, 47, 89, 47, 89, 47, 89, 47, 89, 47, 89, 47, 89,
47, 89, 47, 89, 47, 89, 47, 89, 47, 89, 47, 89, 47, 89, 47, 89, 47, 89,
47, 89, 47, 89, 47, 89, 47, 89, 47, 89, 47, 89
</td>
<td style="text-align:left;">
1938d4f28086e6687ede6b64163e9e3d, 4c364f6f36b13c5e685e9a946b2c38c1
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
394
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
68, 42, 42, 68, 68, 68, 42, 68, 68, 42, 42, 68, 68, 42, 42, 68, 68, 42,
42, 68, 68, 42, 42, 68, 42, 42, 42, 68, 42, 42, 42, 68, 42, 42, 42, 68,
68, 42, 42, 68, 68, 42, 42, 68, 68, 42, 42, 68, 68, 42, 42, 68, 68, 42,
42, 68, 68, 68, 42, 68, 42, 68, 42, 68, 42, 68, 68, 68, 68, 68, 68, 68,
68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 42, 68, 68, 68, 42,
68, 68, 68, 42, 68, 68
</td>
<td style="text-align:left;">
3a41ce4c33d3dd5808b4c225bfb16708, 2caecb59b554231a5158876dcfdda9c5,
d0187d454d53dd08b30854f451e17134, 186af5c5ac9bf632066ea1c6433dac5d
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
397
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
400
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
401
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
412
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
14, 14, 14, 14, 14, 14
</td>
<td style="text-align:left;">
5a04f475aaafb7d8d57fb74d15afdf98
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
414
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
415
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
417
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
424
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
47, 47, 21, 47, 47, 21, 21, 47, 47, 21, 21, 47, 21, 21, 21, 47, 21, 21,
47, 47, 21, 21, 21, 47, 47, 21, 21, 47, 47, 21, 21, 47, 47, 21, 21, 47,
47, 21, 21, 47, 47, 21, 21, 47, 47, 21, 21, 21, 47, 21, 47, 21, 47, 21,
47, 21, 47, 21, 47, 47, 21, 21, 21, 47, 21, 21, 21, 47, 21, 21, 21, 47,
21, 47, 21, 21, 21, 47, 21, 21, 21, 47, 21, 21, 47, 47, 47, 21, 47, 47,
47, 21, 47, 47, 47, 47
</td>
<td style="text-align:left;">
67623df4fcabc563d1c6f770084b8404, cd8b80d9780e7baa568ae43a9e427fed,
e1a6e7b41ade666e1208f821ff536cb3, e629f1bebe0b02832ecc3fe63f457242
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
430
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
436
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
438
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
42, 68, 68, 42, 68, 68, 42, 68, 68, 42, 42, 42, 42, 42, 68, 68, 42, 68,
42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 68, 42, 42, 42, 42, 42, 42, 42,
42, 42, 68, 42, 42, 68, 42, 68, 68, 42, 68, 68, 68, 68, 68, 68, 68, 68,
68, 68, 68, 68, 68, 68, 68, 68, 68, 68, 42, 68, 68, 42, 68, 68, 42, 68
</td>
<td style="text-align:left;">
d50ccfeb495e6304eb2f50069f03decb, 946e804ff63228416dd65529939c9464,
3db0498dafecf7738dd73ec80d75089e
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
451
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86, 86,
86, 86, 86, 86, 86, 86
</td>
<td style="text-align:left;">
a3010796957ecae73d6f2f663164dc88
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
456
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
457
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
463
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
473
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
479
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
480
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
498
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
517
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
524
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
538
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
546
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89, 89,
89, 89, 89, 89, 89, 89
</td>
<td style="text-align:left;">
4c364f6f36b13c5e685e9a946b2c38c1
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
547
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
549
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
551
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14,
14, 14, 14, 14, 14, 14
</td>
<td style="text-align:left;">
5a04f475aaafb7d8d57fb74d15afdf98
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
573
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
587
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53,
53, 53, 53, 53, 53, 53
</td>
<td style="text-align:left;">
0d05caa56fd36e9a1b89ec813cef6de7
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
590
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
596
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
641
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
649
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
652
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81,
81, 81, 81, 81, 81, 81
</td>
<td style="text-align:left;">
7bb9cce5c9911a60f4e7f1e827615768
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
681
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87, 87,
87, 87, 87, 87, 87, 87
</td>
<td style="text-align:left;">
8ff6b39ffbb37ad530e1e02242acd424
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
691
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55,
55, 55, 55, 55, 55, 55
</td>
<td style="text-align:left;">
83cacee044af7e1edd2c042d6d837a1f
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
703
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
708
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
726
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
745
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
754
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
42, 42, 42, 42, 42, 42
</td>
<td style="text-align:left;">
e582bccedae1a8c866136c0c59119502
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
781
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
785
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
811
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
818
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
830
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
844
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88,
88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 88, 64,
88, 64, 88, 64, 88, 64, 88, 64, 88, 88, 88, 88
</td>
<td style="text-align:left;">
195c30a32df1dd776b6aa4a20bc2f924, 0ce52b07bc461926e17172e8f37ab893
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
866
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
872
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85,
85, 85, 85, 85, 85, 85
</td>
<td style="text-align:left;">
d9fc74b6c8e22d6169af05082e17798d
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
886
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
897
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,
64, 64, 64, 64, 64, 64
</td>
<td style="text-align:left;">
14e7f028287c07ea9e875126193d6aca
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
911
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
931
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
947
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
959
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
961
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
963
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
973
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
<tr>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
986
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
NULL
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
</tbody>
</table>
</div>
<p>The first few columns tell us when and where (i.e. which deme)
sampling occurred, the ID of the host, and whether they were positive
for malaria parasites. The next two columns give genetic data (positive
samples only). The <code>haplotypes</code> column gives the raw
information at all 24 loci. Note that each host can be infected with
multiple strains, meaning this element is actually a matrix with one row
for each strain and one column for each locus. We can see this by
printing out the full element for a malaria-positive host:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print raw genetic data</span></span>
<span><span class="va">sim1</span><span class="op">$</span><span class="va">indlevel</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample_ID</span> <span class="op">==</span> <span class="fl">394</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">haplotypes</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span></span>
<span><span class="co">#&gt; [1,]   68   68   68   68   68   68   42   42   42    68    68    68    68    68</span></span>
<span><span class="co">#&gt; [2,]   42   68   42   42   42   42   42   42   42    42    42    42    42    42</span></span>
<span><span class="co">#&gt; [3,]   42   42   42   42   42   42   42   42   42    42    42    42    42    42</span></span>
<span><span class="co">#&gt; [4,]   68   68   68   68   68   68   68   68   68    68    68    68    68    68</span></span>
<span><span class="co">#&gt;      [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]</span></span>
<span><span class="co">#&gt; [1,]    68    42    42    68    68    68    68    68    68    68</span></span>
<span><span class="co">#&gt; [2,]    68    68    68    68    68    68    68    42    42    42</span></span>
<span><span class="co">#&gt; [3,]    42    42    68    68    68    68    68    68    68    68</span></span>
<span><span class="co">#&gt; [4,]    68    68    68    68    68    68    68    68    68    68</span></span></code></pre></div>
<p>Returning to the table, the final column gives the
<code>haplo_ID</code>. This is a hash of the information contained in
each row of the <code>haplotypes</code> matrix, meaning each unique
combination of values over all loci will be given a unique name. This
can be very useful when we only care about unique genotypes and not the
locus-by-locus information contained in those genotypes. For example,
for the same individual as before:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print haplo_ID</span></span>
<span><span class="va">sim1</span><span class="op">$</span><span class="va">indlevel</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample_ID</span> <span class="op">==</span> <span class="fl">394</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">haplo_ID</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] "3a41ce4c33d3dd5808b4c225bfb16708" "2caecb59b554231a5158876dcfdda9c5"</span></span>
<span><span class="co">#&gt; [3] "d0187d454d53dd08b30854f451e17134" "186af5c5ac9bf632066ea1c6433dac5d"</span></span></code></pre></div>
<p>But what do the values in the <code>haplotypes</code> matrix actually
mean? Although we have described them as haplotypes, they <strong>do
not</strong> (yet) represent genetic information. Instead, each value
specifies the ancestor that the information is descended from at the
start of the simulation. For example, if we see a value 68 then we know
that, at this locus, the information eventually traces back to the 68th
seed infection at the start of the simulation. There are two reasons for
encoding information like this:</p>
<ol style="list-style-type: decimal">
<li>It allows us to ask questions about identify by descent (IBD), and
not just identity by state (IBS). If two samples have the same value at
the same locus then we know they are descended from a common ancestor
some time between the start of the simulation and the present day.</li>
<li>We can always go from this ancestral encoding to genotypes; we
simply have to define a genetic value for each unique ancestor at each
locus (we will see an example of this shortly). However, the converse is
not true; we cannot always go back from genotypes to ancestry.</li>
</ol>
<p>Note that two samples having the value 68 does not imply that they
are both <em>direct</em> descendants of the 68th seed infection. Rather,
it implies that these samples have a common ancestor some time between
the start of the simulation and the present day, and <em>this common
ancestor</em> is descended from the 68th seed infection. It is much more
likely that the common ancestor is much more recent than going all the
way back to the start of the simulation.</p>
<p>Look again at the <code>haplotypes</code> matrix for this
poly-clonally infected host. Notice that each row contains blocks of the
values 68 and 42:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print raw genetic data</span></span>
<span><span class="va">sim1</span><span class="op">$</span><span class="va">indlevel</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample_ID</span> <span class="op">==</span> <span class="fl">394</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">haplotypes</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span></span>
<span><span class="co">#&gt; [1,]   68   68   68   68   68   68   42   42   42    68    68    68    68    68</span></span>
<span><span class="co">#&gt; [2,]   42   68   42   42   42   42   42   42   42    42    42    42    42    42</span></span>
<span><span class="co">#&gt; [3,]   42   42   42   42   42   42   42   42   42    42    42    42    42    42</span></span>
<span><span class="co">#&gt; [4,]   68   68   68   68   68   68   68   68   68    68    68    68    68    68</span></span>
<span><span class="co">#&gt;      [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]</span></span>
<span><span class="co">#&gt; [1,]    68    42    42    68    68    68    68    68    68    68</span></span>
<span><span class="co">#&gt; [2,]    68    68    68    68    68    68    68    42    42    42</span></span>
<span><span class="co">#&gt; [3,]    42    42    68    68    68    68    68    68    68    68</span></span>
<span><span class="co">#&gt; [4,]    68    68    68    68    68    68    68    68    68    68</span></span></code></pre></div>
<p>What we are looking at here is recombination break points. We could
use this matrix to identify blocks of IBD within a sample, or compare
this matrix with another to explore IBD between samples.</p>
<p>Let’s see how we can convert these ancestral encodings to
genotypes.</p>
</div>
<div class="section level2">
<h2 id="example-with-migration">Example with migration<a class="anchor" aria-label="anchor" href="#example-with-migration"></a>
</h2>
<p>PlasmoSim incorporates migration of hosts between demes using a
migration matrix. We have to be careful when simulating stochastic
movement of people between demes, as if we simply give each person a
random chance of moving from one deme to another taken from this
migration matrix then deme population sizes will drift up and down at
random and eventually we will see demes emptying entirely. To get around
this we do matched migration, meaning people swap places between demes
rather than moving independently. This satisfies the migration matrix,
while also ensuring that population sizes stay constant throughout the
simulation. We do not model mosquito movement in this version of the
package.</p>
<p>We start by creating a grid of demes, and for each deme specifying
its properties, such as the mosquito population size and the number of
seeding infections. In our case we will make the density of mosquitoes
(and hence the EIR) increase from left to right of the domain. Note that
human population sizes must be the same for all demes due to the
migration constraint described above. We will start by seeding
infections in just one deme in the lower left corner:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define x- and y-locations of demes</span></span>
<span><span class="va">demes_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">demes_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get coordinates into dataframe</span></span>
<span><span class="va">deme_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">demes_x</span>, <span class="va">demes_y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">deme_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add deme-specific properties</span></span>
<span><span class="va">deme_df</span> <span class="op">&lt;-</span> <span class="va">deme_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>deme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">deme_df</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                M <span class="op">=</span> <span class="fl">500</span> <span class="op">+</span> <span class="va">x</span>, <span class="co"># mosquito population size increasing from left to right</span></span>
<span>                seed_infections <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">y</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">deme_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;    x y deme   M seed_infections</span></span>
<span><span class="co">#&gt; 1  0 0    1 500              50</span></span>
<span><span class="co">#&gt; 2 10 0    2 510               0</span></span>
<span><span class="co">#&gt; 3 20 0    3 520               0</span></span>
<span><span class="co">#&gt; 4 30 0    4 530               0</span></span>
<span><span class="co">#&gt; 5 40 0    5 540               0</span></span>
<span><span class="co">#&gt; 6 50 0    6 550               0</span></span></code></pre></div>
<p>Next we need to make a migration matrix. We first calculate the
distance between all demes, and then we will create a small amount of
migration between adjacent demes only. The migration matrix must sum to
one over rows to be accepted by the program:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define migration matrix based on distance</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">deme_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mig_matrix</span> <span class="op">&lt;-</span> <span class="fl">0.01</span> <span class="op">*</span> <span class="op">(</span><span class="va">d</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ensure migration probabilities sum to 1 over rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">mig_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">mig_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">mig_matrix</span><span class="op">)</span></span></code></pre></div>
<p>Next we need to define our sampling strategy. We will sample 100
individuals from a subset of demes after a full 10 years of simulation
(genetic patterns take a long time to settle down, much longer than
prevalence for example). For convenience we produce the sampling
dataframe directly from the <code>deme_df</code> dataframe defined
above, although only the columns <code>deme</code>, <code>time</code>
and <code>n</code> will be used sampling.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define output dataframe</span></span>
<span><span class="va">sample_df</span> <span class="op">&lt;-</span> <span class="va">deme_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">deme</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">26</span>, <span class="fl">35</span>, <span class="fl">109</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">30</span> <span class="op">*</span> <span class="fl">365</span>,</span>
<span>                n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_df</span></span>
<span><span class="co">#&gt;    x  y deme   M seed_infections  time   n</span></span>
<span><span class="co">#&gt; 1 10 10   13 510               0 10950 100</span></span>
<span><span class="co">#&gt; 2 30 20   26 530               0 10950 100</span></span>
<span><span class="co">#&gt; 3 10 30   35 510               0 10950 100</span></span>
<span><span class="co">#&gt; 4 90 90  109 590               0 10950 100</span></span></code></pre></div>
<p>Now we can run the simulation, using the values in
<code>deme_df</code> to specify the mosquito population size and the
seeding infections:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">sim_mig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_falciparum.html">sim_falciparum</a></span><span class="op">(</span>H <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                          M <span class="op">=</span> <span class="va">deme_df</span><span class="op">$</span><span class="va">M</span>,</span>
<span>                          seed_infections <span class="op">=</span> <span class="va">deme_df</span><span class="op">$</span><span class="va">seed_infections</span>,</span>
<span>                          mig_matrix <span class="op">=</span> <span class="va">mig_matrix</span>,</span>
<span>                          L <span class="op">=</span> <span class="fl">24</span>,</span>
<span>                          sample_dataframe <span class="op">=</span> <span class="va">sample_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running simulation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; simulation completed in 10.8416 seconds</span></span>
<span><span class="co">#&gt; processing output</span></span></code></pre></div>
<p>As before, we can produce a simple plot of prevalence over time, now
broken down by deme. We can see how the wave of infection swept through
the demes as infected hosts migrated through the space:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># basic plot of prevalence in "I" state (infected)</span></span>
<span><span class="va">sim_mig</span><span class="op">$</span><span class="va">daily_values</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">&lt;</span> <span class="fl">365</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">I</span> <span class="op">/</span> <span class="fl">100</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">deme</span><span class="op">)</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Prevalence (%)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_basic_files/figure-html/unnamed-chunk-15-1.png" width="70%" height="70%"></p>
<p>We can visualise this spatially by filtering to a certain timepoint
and then producing a raster plot. For example, here is the prevalence
map 5 years into the simulation:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset daily output to specific timepoint and merge back with deme properties</span></span>
<span><span class="va">daily_values_sub</span> <span class="op">&lt;-</span> <span class="va">sim_mig</span><span class="op">$</span><span class="va">daily_values</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">5</span><span class="op">*</span><span class="fl">365</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">deme_df</span>, by <span class="op">=</span> <span class="st">"deme"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># produce raster plot</span></span>
<span><span class="va">daily_values_sub</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_raster</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">I</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span>option <span class="op">=</span> <span class="st">"magma"</span>, name <span class="op">=</span> <span class="st">"Prevalence (%)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_basic_files/figure-html/unnamed-chunk-16-1.png" width="70%" height="70%"></p>
<p>We can see that five years into our simulation the wave of infection
had still not quite reached the top-right corner of our domain.
Prevalence also appears to be higher towards the right of the domain, a
consequence of assuming increasing mosquito population size from left to
right. We can produce the same plot at 30 years into simulation:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset daily output to specific timepoint and merge back with deme properties</span></span>
<span><span class="va">daily_values_sub</span> <span class="op">&lt;-</span> <span class="va">sim_mig</span><span class="op">$</span><span class="va">daily_values</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">30</span><span class="op">*</span><span class="fl">365</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">deme_df</span>, by <span class="op">=</span> <span class="st">"deme"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># produce raster plot</span></span>
<span><span class="va">daily_values_sub</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_raster</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">I</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span>option <span class="op">=</span> <span class="st">"magma"</span>, name <span class="op">=</span> <span class="st">"Prevalence (%)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_basic_files/figure-html/unnamed-chunk-17-1.png" width="70%" height="70%"></p>
<p>Now prevalence appears to be roughly at equilibrium, with higher
transmission uniformly along the right of the domain.</p>
<p>Returning to our genetic sample, we asked the program to draw 100
individuals at random from four demes on the final day of simulation. We
can calculate the pairwise genetic identity between all pairs of
individuals in this sample using the function. Genetic identity is
calculated as the proportion of identical genetic values over all
possible pairs of haplotypes compared between two individuals. This
means two individuals will only have identity = 1 if they are monoclonal
and matching at every locus. It follows that an individual will be less
than perfectly identical to itself if it carries multiple distinct
haplotypes. As long as genetic values represent ancestry, as they do in
this simulation, what we are really measuring here is average identity
by descent (IBD) between haplotypes. If genetic values were converted
into alleles prior to running this function then we would be measuring
identity by state (IBS).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get pairwise genetic identity between all individuals</span></span>
<span><span class="va">indlevel_identity</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_identity_matrix.html">get_identity_matrix</a></span><span class="op">(</span><span class="va">sim_mig</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get into long form dataframe</span></span>
<span><span class="va">n_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">indlevel_identity</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">df_indlevel_identity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_pos</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_pos</span><span class="op">)</span></span>
<span><span class="va">df_indlevel_identity</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">indlevel_identity</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot pairwise matrix</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df_indlevel_identity</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_void</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_raster</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Var1</span>, y <span class="op">=</span> <span class="va">Var2</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span>option <span class="op">=</span> <span class="st">"magma"</span>, name <span class="op">=</span> <span class="st">"Identity by descent"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_basic_files/figure-html/unnamed-chunk-18-1.png" width="70%" height="70%"></p>
<p>We can also use the same function to summarise genetic identity at
the deme level rather than the individual level through the
<code>deme_level = TRUE</code> argument:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get pairwise genetic identity between all demes</span></span>
<span><span class="va">demelevel_identity</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_identity_matrix.html">get_identity_matrix</a></span><span class="op">(</span><span class="va">sim_mig</span>, deme_level <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get into long form dataframe</span></span>
<span><span class="va">n_deme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">demelevel_identity</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">df_demelevel_identity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>deme1 <span class="op">=</span> <span class="va">sample_df</span><span class="op">$</span><span class="va">deme</span>, deme2 <span class="op">=</span> <span class="va">sample_df</span><span class="op">$</span><span class="va">deme</span><span class="op">)</span></span>
<span><span class="va">df_demelevel_identity</span><span class="op">$</span><span class="va">IBD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">demelevel_identity</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot pairwise matrix</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df_demelevel_identity</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_raster</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">deme1</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">deme2</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">IBD</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"deme1"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"deme2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span>option <span class="op">=</span> <span class="st">"magma"</span>, name <span class="op">=</span> <span class="st">"Identity by descent"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_basic_files/figure-html/unnamed-chunk-19-1.png" width="40%" height="40%"></p>
<p>We can see that some demes are more closely related than others. We
can visualise this spatially by drawing edges between our sampled demes,
with edge thickness/colour proportional to IBD:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># append deme coordinates</span></span>
<span><span class="va">sample_df_simple</span> <span class="op">&lt;-</span> <span class="va">sample_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">deme</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_demelevel_identity</span> <span class="op">&lt;-</span> <span class="va">df_demelevel_identity</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>deme <span class="op">=</span> <span class="va">deme1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sample_df_simple</span>, by <span class="op">=</span> <span class="st">"deme"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>deme1 <span class="op">=</span> <span class="va">deme</span>,</span>
<span>                deme <span class="op">=</span> <span class="va">deme2</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sample_df_simple</span>, by <span class="op">=</span> <span class="st">"deme"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>deme2 <span class="op">=</span> <span class="va">deme</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot pairwise IBD</span></span>
<span><span class="va">df_demelevel_identity</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">deme1</span> <span class="op">!=</span> <span class="va">deme2</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_segment</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x.x</span>, y <span class="op">=</span> <span class="va">y.x</span>, xend <span class="op">=</span> <span class="va">x.y</span>, yend <span class="op">=</span> <span class="va">y.y</span>, size <span class="op">=</span> <span class="va">IBD</span>, col <span class="op">=</span> <span class="va">IBD</span><span class="op">)</span>,</span>
<span>               lineend <span class="op">=</span> <span class="st">"round"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylim</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>size <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<p><img src="tutorial_basic_files/figure-html/unnamed-chunk-20-1.png" width="70%" height="70%"></p>
<p>On average we would expect to see thaht demes closer together would
be more highly related, although this will also be influenced in complex
ways by relative transmission intensity.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bob Verity.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
